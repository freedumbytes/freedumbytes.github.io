<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Appendix A. Tips &amp; Tricks</title><link rel="stylesheet" type="text/css" href="docbook.css"/><link rel="stylesheet" type="text/css" href="css/freedumbytes.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"/><link rel="prev" href="quality.assurance.html" title="Chapter 17. Quality Assurance"/><link rel="next" href="prj.repo.svc.site.hosting.html" title="Appendix B. Hosting a group Website in the Cloud"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="shortcut icon" href="./images/community/docbook/glider.ico"/></head><body><header><p id="title"/><ul class="navheader"><li class="previous"><a accesskey="p" href="quality.assurance.html"><strong>Previous</strong></a></li><li class="next"><a accesskey="n" href="prj.repo.svc.site.hosting.html"><strong>Next</strong></a></li></ul></header><section class="appendix" id="tips.and.tricks"><div class="titlepage"><div><div><h1 class="title"><a id="tips.and.tricks" class="anchor" href="#tips.and.tricks"><span class="octicon octicon-link"/></a>Appendix A. Tips &amp; Tricks</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="tips.and.tricks.html#tip.archive">A.1. Archives</a></span><ul><li><span class="section"><a href="tips.and.tricks.html#tip.archive.msi">A.1.1. How to extract content from MSI files</a></span></li><li><span class="section"><a href="tips.and.tricks.html#tip.class.path">A.1.2. How to determine absolute path of a loaded Class</a></span></li></ul></li><li><span class="section"><a href="tips.and.tricks.html#tip.version.control.system">A.2. Version Control System</a></span><ul><li><span class="section"><a href="tips.and.tricks.html#tip.vcs.svnsgit.migration">A.2.1. SVN to Git Migration</a></span></li><li><span class="section"><a href="tips.and.tricks.html#vcs.git.gitweb.enhancement">A.2.2. GitWeb enhancement</a></span></li></ul></li></ul></div><section class="section" id="tip.archive"><div class="titlepage"><div><div><h2 class="title"><a id="tip.archive" class="anchor" href="#tip.archive"><span class="octicon octicon-link"/></a>A.1. Archives</h2></div></div></div><section class="section" id="tip.archive.msi"><div class="titlepage"><div><div><h3 class="title"><a id="tip.archive.msi" class="anchor" href="#tip.archive.msi"><span class="octicon octicon-link"/></a>A.1.1. How to extract content from MSI files</h3></div></div></div><p><span class="inlinemediaobject"><img src="images/icons/windows.png"/></span> While there are plenty of utilities available
        to extract the contents of an MSI file, you can do it straight from
        the command line: <code class="command"><a class="link" href="http://technet.microsoft.com/en-us/library/bb490936.aspx">msiexec</a>
        /a <em class="replaceable"><code>file.msi</code></em> /qb
        TARGETDIR=<em class="replaceable"><code>folder</code></em></code>.</p></section><section class="section" id="tip.class.path"><div class="titlepage"><div><div><h3 class="title"><a id="tip.class.path" class="anchor" href="#tip.class.path"><span class="octicon octicon-link"/></a>A.1.2. How to determine absolute path of a loaded Class</h3></div></div></div><p>Of course, this is not always possible (if you think of
        dynamically created classes), but if the loaded Class is inside a jar
        <a class="link" href="http://stackoverflow.com/questions/4546632/how-to-determine-absolute-path-if-any-of-a-loaded-class">how
        to get the absolute path for this jar</a>?</p><pre xmlns="" class="language-provided"><code class="language-java">package nl.demon.shadowland.freedumbytes.maven.qa.sandbox.classloader;


import static org.assertj.core.api.Assertions.*;

import org.junit.*;


public class ClassloaderTest
{
  @Test()
  public void testClassloaderResourceRequiresRelativePath()
  {
    assertThat(getClass().getClassLoader().getResource("/net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class")).isNull();

    System.out.println(getClass().getClassLoader().getResource("net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class"));
    assertThat(getClass().getClassLoader().getResource("net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class").toString())
        .endsWith("qa-sandbox/target/test-classes/net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class");
  }


  @Test()
  public void testClassResourceRequiresAbsolutePath()
  {
    assertThat(getClass().getResource("net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class")).isNull();

    System.out.println(getClass().getResource("/net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class"));
    assertThat(getClass().getResource("/net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class").toString())
        .endsWith("qa-sandbox/target/test-classes/net/dev/freedumbytes/maven/qa/sandbox/classloader/ClassloaderTest.class");
  }


  @Test()
  public void testAbsolutePathOfLoadedClass()
  {
    System.out.println(ClassloaderTest.class.getProtectionDomain().getCodeSource().getLocation().getPath());
    assertThat(ClassloaderTest.class.getProtectionDomain().getCodeSource().getLocation().getPath())
        .endsWith("qa-sandbox/target/test-classes/");
  }
}
</code></pre></section></section><section class="section" id="tip.version.control.system"><div class="titlepage"><div><div><h2 class="title"><a id="tip.version.control.system" class="anchor" href="#tip.version.control.system"><span class="octicon octicon-link"/></a>A.2. Version Control System</h2></div></div></div><section class="section" id="tip.vcs.svnsgit.migration"><div class="titlepage"><div><div><h3 class="title"><a id="tip.vcs.svnsgit.migration" class="anchor" href="#tip.vcs.svnsgit.migration"><span class="octicon octicon-link"/></a>A.2.1. SVN to Git Migration</h3></div></div></div><p>Migrating from Subversion to Git with svn2git, a Ruby tool for
        importing existing svn projects into git.</p><p><span class="inlinemediaobject"><img src="images/icons/github.png"/></span> <a class="link" href="https://github.com/nirvdrum/svn2git">svn2git</a> is a
        tiny utility for migrating projects from Subversion to Git while
        keeping the trunk, branches and tags where they should be. It uses
        git-svn to clone an svn repository and does some clean-up to make sure
        branches and tags are imported in a meaningful way, and that the code
        checked into master ends up being what's currently in your svn trunk
        rather than whichever svn branch your last commit was in.</p><section class="section" id="tip.vcs.svnsgit.migration.resources"><div class="titlepage"><div><div><h4 class="title"><a id="tip.vcs.svnsgit.migration.resources" class="anchor" href="#tip.vcs.svnsgit.migration.resources"><span class="octicon octicon-link"/></a>A.2.1.1. Resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p>Migrating from Subversion to Git with svn2git on Windows
              (<a class="link" href="https://www.troyhunt.com/migrating-from-subversion-to-git-with/">the
              tricky bits explained)</a>.</p></li><li class="listitem"><p>Issue <a class="link" href="https://github.com/nirvdrum/svn2git/issues/121">#121</a>
              "--exclude" option does not work on Windows.</p></li><li class="listitem"><p>Issue <a class="link" href="https://github.com/nirvdrum/svn2git/issues/20">#20</a>
              --exclude works great, but is there a way to not include the
              empty commits?</p></li><li class="listitem"><p><a class="link" href="https://help.github.com/articles/dealing-with-line-endings/#platform-all">Dealing
              with line endings</a>.</p></li><li class="listitem"><p><a class="link" href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes">Customizing
              Git - Git Attributes</a> from the Pro Git book.</p></li><li class="listitem"><p><a class="link" href="https://git-scm.com/docs/git-config">git-config</a>
              - Get and set repository or global options.</p></li><li class="listitem"><p><a class="link" href="http://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/">Mind
              the End of Your Line</a>.</p></li><li class="listitem"><p><a class="link" href="http://stackoverflow.com/questions/1510798/trying-to-fix-line-endings-with-git-filter-branch-but-having-no-luck/4683783#4683783">Trying
              to fix line-endings with git filter-branch</a>, but having no
              luck.</p></li><li class="listitem"><p><a class="link" href="http://fieldlevel.github.io/2015/10/21/fixing-lineending-conflicts-with-git/">Git
              lineendings and better diffs</a></p></li><li class="listitem"><p><span class="inlinemediaobject"><img src="images/icons/github.png"/></span> <a class="link" href="https://github.com/alexkaratarakis/gitattributes">A
              Collection of Useful <code class="filename">.gitattributes</code>
              Templates</a>.</p></li><li class="listitem"><p><span class="inlinemediaobject"><img src="images/icons/github.png"/></span> <a class="link" href="https://github.com/github/gitignore">A Collection of
              <code class="filename">.gitignore</code> templates</a>.</p></li></ul></div></section><section class="section" id="prg.ruby.install.guide"><div class="titlepage"><div><div><h4 class="title"><a id="prg.ruby.install.guide" class="anchor" href="#prg.ruby.install.guide"><span class="octicon octicon-link"/></a>A.2.1.2. Ruby installation guide</h4></div></div></div><p><a class="link" href="https://www.ruby-lang.org/">Ruby</a> is a
          dynamic, open source programming language with a focus on simplicity
          and productivity. It has an elegant syntax that is natural to read
          and easy to write.</p><p><a class="link" href="http://rubyinstaller.org/downloads/">Download</a> the
          Ruby Installer <code class="filename">rubyinstaller-2.3.3-x64.exe</code> for
          Windows [version <a class="link" href="http://rubyinstaller.org/">2.3.3</a>].</p><p>Run this <code class="filename">.exe</code> file to
          install Ruby in <code class="filename">P:\dev\apps\prg\ruby-2.3.3</code>.</p><p id="prg.ruby.home"><a id="prg.ruby.home"><span style="display:none;">trick</span></a>Press <span class="keycap"><strong><span class="inlinemediaobject"><img src="images/os/windows/windows-key.gif"/></span></strong></span>+<span class="keycap"><strong>Break</strong></span> keys to open the Windows System Properties. Select
          <span class="guisubmenu"><strong>Advanced system settings</strong></span> → <span class="guibutton"><strong>Enviro<span class="accel">n</span>ment Variables</strong></span> and <span class="guibutton"><strong>Ed<span class="accel">i</span>t</strong></span> the
          <code class="envar">Path</code> to append
          <strong class="userinput"><code>%RUBY_HOME%\bin;</code></strong>. Also add a
          <span class="guibutton"><strong>Ne<span class="accel">w</span></strong></span> system variable
          <code class="envar">RUBY_HOME</code> pointing to <strong class="userinput"><code><code class="filename">P:\dev\apps\prg\ruby-2.3.3</code></code></strong>.</p><p>Verify the installation with <code class="command">ruby
          --version</code>.</p></section><section class="section" id="prg.rubygems.install.guide"><div class="titlepage"><div><div><h4 class="title"><a id="prg.rubygems.install.guide" class="anchor" href="#prg.rubygems.install.guide"><span class="octicon octicon-link"/></a>A.2.1.3. RubyGems upgrade guide</h4></div></div></div><p><a class="link" href="https://rubygems.org/">RubyGems</a> is a
          package management framework for Ruby.</p><p><a class="link" href="https://rubygems.org/pages/download">Download</a> the
          archive <code class="filename">rubygems-2.6.12.zip</code> for Windows
          [version <a class="link" href="http://blog.rubygems.org/">2.6.12</a>].</p><p>Extract this <code class="filename">.zip</code> file
          to <code class="filename">C:\tmp</code>. In <code class="filename">C:\tmp\rubygems-2.6.12</code> run
          <code class="command">ruby setup.rb</code>.</p><p>Verify the installation with <code class="command">gem
          --version</code>.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>This upgrade fixes the following issue when installing
            svn2git: <span class="quote">“<span class="quote">ERROR: Could not find a valid gem 'svn2git' (&gt;=
            0), here is why: Unable to download data from
            https://rubygems.org/ - SSL_connect returned=1 errno=0 state=SSLv3
            read server certificate</span>”</span>.</p></div></section><section class="section" id="prg.ruby.gem.svn2git.install.guide"><div class="titlepage"><div><div><h4 class="title"><a id="prg.ruby.gem.svn2git.install.guide" class="anchor" href="#prg.ruby.gem.svn2git.install.guide"><span class="octicon octicon-link"/></a>A.2.1.4. svn2git installation guide</h4></div></div></div><p>Install the svn2git gem with <code class="command">gem install svn2git
          --version 2.3.2</code> [version <a class="link" href="https://rubygems.org/gems/svn2git">2.4.0</a>].</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="warning"><h2>Warning</h2><p>Usage of version 2.4.0 results in an empty Git repository
            and the error message: <span class="quote">“<span class="quote">command failed: git checkout -f
            master</span>”</span>.</p></div><p>Verify the installation with <code class="command">gem list</code> or
          <code class="command">svn2git --help</code>.</p></section><section class="section" id="tip.vcs.svn2git.example"><div class="titlepage"><div><div><h4 class="title"><a id="tip.vcs.svn2git.example" class="anchor" href="#tip.vcs.svn2git.example"><span class="octicon octicon-link"/></a>A.2.1.5. Migration example</h4></div></div></div><p>Because the Java.net and Kenai.com forges will be <a class="link" href="https://community.oracle.com/community/java/javanet-forge-sunset">going
          dark</a> on April 28, 2017 lets migrate the jmodalwindow's
          sources that I was hosting there.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>To convert all the svn <a class="link" href="https://github.com/nirvdrum/svn2git#authors">authors</a>
            to git format, create the file
            <code class="filename">C:\dev\projects\demo\users.txt</code> with for
            example:</p><pre class="language-provided"><code class="language-ini">(no author) = Jene Jasper &lt;jene.jasper@shadowland.demon.nl&gt;
jjasper = Jene Jasper &lt;jene.jasper@shadowland.demon.nl&gt;
tigrisc = Jene Jasper &lt;jene.jasper@shadowland.demon.nl&gt;
</code></pre></div><pre xmlns="" class="language-provided"><code class="language-bash">cd /d C:\dev\projects
mkdir jmodalwindow
cd jmodalwindow

svn2git --verbose https://svn.java.net/svn/jmodalwindow~svn/ ^
        --no-minimize-url --nobranches ^
        --author c:\dev\projects\demo\users.txt
</code></pre><section class="section" id="tip.vcs.svn2git.example.exclude.fix"><div class="titlepage"><div><div><h5 class="title"><a id="tip.vcs.svn2git.example.exclude.fix" class="anchor" href="#tip.vcs.svn2git.example.exclude.fix"><span class="octicon octicon-link"/></a>A.2.1.5.1. Exclude fix</h5></div></div></div><p>But this way the whole history of the website that is
            maintained in the <code class="filename">www</code>
            folder. Thus lets try the option <code class="option">--exclude www</code>.
            Alas this results in the following error <span class="quote">“<span class="quote">'tags[' is not
            recognized as an internal or external command,</span>”</span> when
            <code class="computeroutput">Running command: git svn fetch
            '--ignore-paths=^(?:trunk[/]|tags[/][^/]+[/])(?:www)'</code>
            (see also the above mentioned resource about issue <a class="link" href="https://github.com/nirvdrum/svn2git/issues/121">#121</a>).</p><p>To avoid this error edit
            <code class="filename">P:\dev\apps\prg\ruby-2.3.3\lib\ruby\gems\2.3.0\gems\svn2git-2.3.2\lib\svn2git\migration.rb</code>:</p><pre xmlns="" class="language-provided"><code class="language-ruby">         regex = '^(?:' + regex.join('|') + ')(?:' + exclude.join('|') + ')'
-        cmd += "'--ignore-paths=#{regex}'"
+        cmd += "\"--ignore-paths=#{regex}\""
       end
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>Or just run
              <code class="command">p:\dev\apps\editor\winmerge\WinMergeU.exe
              P:\dev\apps\prg\ruby-2.3.3\lib\ruby\gems\2.3.0\gems\svn2git-2.3.2\
              P:\dev\apps\prg\ruby-2.3.1\lib\ruby\gems\2.3.0\gems\svn2git-2.3.2\</code>
              to copy the changes in
              <code class="filename">lib\svn2git\migration.rb</code> from a prior
              installation of ruby.</p></div><p>Run the fixed script again:</p><pre xmlns="" class="language-provided"><code class="language-bash">svn2git --verbose https://svn.java.net/svn/jmodalwindow~svn/ ^
        --no-minimize-url --nobranches ^
        --exclude www ^
        --author c:\dev\projects\demo\users.txt
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>In case of a failure delete the <code class="filename">.git</code>
              init folder and any other files first before rerunning
              svn2git.</p></div></section><section class="section" id="tip.vcs.svn2git.example.empty.commits"><div class="titlepage"><div><div><h5 class="title"><a id="tip.vcs.svn2git.example.empty.commits" class="anchor" href="#tip.vcs.svn2git.example.empty.commits"><span class="octicon octicon-link"/></a>A.2.1.5.2. Empty commits</h5></div></div></div><p>Now the content of the folder <code class="filename">www</code> is gone but the commits
            themselves are still there as empty remnants.</p><pre xmlns="" class="language-provided"><code class="language-bash">git log --pretty=oneline
</code></pre><p>To remove them just run (see also the above mentioned
            resource about issue <a class="link" href="https://github.com/nirvdrum/svn2git/issues/20">#20</a>):</p><pre xmlns="" class="language-provided"><code class="language-bash">git filter-branch -f --prune-empty --tag-name-filter cat -- --all
git filter-branch -f
git reflog expire --expire=now --all
git gc --prune=now --aggressive
git log --pretty=oneline
</code></pre></section></section><section class="section" id="tip.vcs.svn2git.eol"><div class="titlepage"><div><div><h4 class="title"><a id="tip.vcs.svn2git.eol" class="anchor" href="#tip.vcs.svn2git.eol"><span class="octicon octicon-link"/></a>A.2.1.6. End Of Line</h4></div></div></div><p>Git's primary solution is to specify that <code class="option">LF</code>
          is the best way to store line endings for text files in a Git
          repository's object database (see also <a class="link" href="http://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/">Mind
          the End of Your Line</a>). When writing to the object database or
          writing out into the working directory Git has a chance to run
          filters and do things like converting line endings. Originally the
          conversion was handled with <code class="option">core.autocrlf</code>. Run
          <code class="command">git config --list --show-origin</code> or <code class="command">git
          config --show-origin core.autocrlf</code> to see what this value
          is set to. On Windows, you simply pass true to the configuration
          with <code class="command">git config --global core.autocrlf
          true</code>.</p><p>Alternatively define all of this in the <code class="filename"><a class="link" href="https://gitlab.com/freedumbytes/setup/raw/master/.gitattributes">.gitattributes</a></code>
          file that you keep with your repository. This means that line
          endings can be encapsulated entirely within a repository and don't
          depend on everyone having the proper global settings. For example
          <code class="filename">C:\dev\projects\jmodalwindow\.gitattributes</code>
          based on <code class="filename">Java.gitattributes</code> of
          <span class="inlinemediaobject"><img src="images/icons/github.png"/></span> <a class="link" href="https://github.com/alexkaratarakis/gitattributes">.gitattributes
          Templates</a>:</p><pre xmlns="" class="language-provided"><code class="language-ini"># Handle line endings automatically for files detected as text
# and leave all files detected as binary untouched.
* text=auto
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#
# The above will handle all files NOT found below
#
# These files are text and should be normalized (Convert crlf =&gt; lf)
.gitattributes  text
.gitignore      text
.gitkeep        text
.gitconfig      text
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">*.bat           text
*.cmd           text
*.sh            text eol=lf
Makefile        text
makefile        text
Dockerfile      text
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">*.java          text
*.jsp           text
*.jspf          text
*.jspx          text
*.tag           text
*.tagx          text
*.tld           text
*.ldif          text
*.ctl           text
*.sql           text
*.feature       text
*.plantuml      text
*.graphml       text
Jenkinsfile     text
*.yml           text
*.yaml          text
*.raml          text
*.diff          text diff -merge
*.patch         text diff -merge
*.properties    text
*.MF            text
*.mapping       text
*.ini           text
*.cnf           text
*.conf          text
*.config        text
*.pageflow      text
*.launch        text
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">*.txt           text
*.apt           text
*.vm            text
*.log           text
*.importorder   text
*.xsl           text
*.xslt          text
*.xml           text
*.dtd           text
*.xsd           text
*.wsdl          text
*.wsdd          text
*.xjb           text
*.php           text
*.md            text
*.adoc          text
*.csv           text
*.ftl           text
*.jrxml         text
*.dwt           text
*.pu            text
*.archimate     text
*.ucls          text
*.uxf           text
.editorconfig   text
*.dia           binary
*.doc           binary
*.docm          binary
*.docx          binary
*.dot           binary
*.dotx          binary
*.msg           binary
*.ppt           binary
*.pptm          binary
*.pptx          binary
*.pdf           binary
*.odt           binary
*.ai            binary
*.rtf           binary
*.vsd           binary
*.xls           binary
*.xlsm          binary
*.xlsx          binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">*.asp           text
*.h             text
*.css           text
*.less          text
*.sass          text
*.scss          text
*.htm           text
*.html          text
*.xhtml         text
*.faces         text
*.mht           text
*.ts            text
*.js            text
*.jsx           text
*.json          text
*.coffee        text
.htaccess       text
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini"># These files are binary and should be left untouched
# (binary is a macro for -text -diff)
#
#image
*.bmp           binary
*.eps           binary
*.gif           binary
*.ico           binary
*.jng           binary
*.jpg           binary
*.jpeg          binary
*.jpx           binary
*.jp2           binary
*.jxr           binary
*.mng           binary
*.png           binary
*.psb           binary
*.psd           binary
*.svg           -text diff -merge
*.svgz          binary
*.tif           binary
*.tiff          binary
*.wbmp          binary
*.webp          binary
Thumbs.db       binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#audio
*.m4a           binary
*.mid           binary
*.midi          binary
*.mp3           binary
*.ogg           binary
*.ra            binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#video
*.3gpp          binary
*.3gp           binary
*.asf           binary
*.fla           binary
*.flv           binary
*.m4v           binary
*.mov           binary
*.mp4           binary
*.mpeg          binary
*.mpg           binary
*.swc           binary
*.swf           binary
*.webm          binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#font
*.eot           binary
*.otf           binary
*.ttf           binary
*.woff          binary
*.woff2         binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#compiled
*.com           binary
*.class         binary
*.dll           binary
*.exe           binary
*.o             binary
*.so            binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#archive
*.jar           binary
*.ear           binary
*.war           binary
*.7z            binary
*.rar           binary
*.tar           binary
*.zip           binary
*.gz            binary
*.tgz           binary
</code></pre><pre xmlns="" class="language-provided"><code class="language-ini">#certificate
*.pem           text
*.p12           binary
*.pfx           binary
*.jks           binary
*.jceks         binary
cacerts         binary
jssecacerts     binary
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>Seeing the <code class="filename">.class</code>
            binary mapping reminds me to add an
            <code class="filename">C:\dev\projects\jmodalwindow\.gitignore</code> based
            on the <a class="link" href="version.control.system.html#vcs.git.ignore.template" title="11.1.2.5. Ignores template">ignores
            template</a>.</p></div><div style="margin-left: 0.5in; margin-right: 0.5in;" class="tip"><h2>Tip</h2><p>Use <code class="command">git ls-files --eol | grep auto</code> to
            identify files that aren't covered by
            <code class="filename">.gitattributes</code> and thus are marked for
            automatic end-of-line conversion.</p></div><section class="section" id="tip.vcs.svn2git.eol.pattern.overrides"><div class="titlepage"><div><div><h5 class="title"><a id="tip.vcs.svn2git.eol.pattern.overrides" class="anchor" href="#tip.vcs.svn2git.eol.pattern.overrides"><span class="octicon octicon-link"/></a>A.2.1.6.1. Pattern matches and overrides</h5></div></div></div><p><a class="link" href="https://git-scm.com/docs/gitattributes">.gitattributes
            defining attributes</a> per path. When more than one pattern
            matches the path, a later line overrides an earlier line. The
            rules how the pattern matches paths are the same as in <a class="link" href="https://git-scm.com/docs/gitignore">.gitignore
            files</a>. Unlike <code class="filename">.gitignore</code>, negative
            patterns are forbidden.</p><p>For example define project specific override settings for
            <code class="filename">.xml</code> files at the end of
            the <code class="filename">.gitattributes</code> file:</p><pre xmlns="" class="language-provided"><code class="language-ini"># Project Specific ###
**/tst/windows/*.xml  text eol=crlf
**/tst/linux/*.xml    text eol=lf
</code></pre></section><section class="section" id="tip.vcs.svn2git.eol.refresh"><div class="titlepage"><div><div><h5 class="title"><a id="tip.vcs.svn2git.eol.refresh" class="anchor" href="#tip.vcs.svn2git.eol.refresh"><span class="octicon octicon-link"/></a>A.2.1.6.2. Refreshing the repository after changing line
            endings</h5></div></div></div><p>Save your current files in Git, so that none of your work is
            lost (see also <a class="link" href="https://help.github.com/articles/dealing-with-line-endings/#platform-all">Dealing
            with line endings</a>):</p><pre xmlns="" class="language-provided"><code class="language-bash">git add .gitignore
git add .gitattributes
git commit -m "Config git ignore and attributes"
</code></pre><p>Remove Git's index:</p><pre xmlns="" class="language-provided"><code class="language-bash">del .git\index or rm .git/index
</code></pre><p>Rewrite the Git index to pick up all the new line
            endings:</p><pre xmlns="" class="language-provided"><code class="language-bash">git reset
</code></pre><p>Add all your changed files back, and prepare them for a
            commit. This is your chance to inspect which files, if any, were
            unchanged. Also check that the only changes you are committing are
            the line endings:</p><pre xmlns="" class="language-provided"><code class="language-bash">git status
git diff --ignore-space-at-eol
git add . -u
</code></pre><p>Commit the changes to your repository:</p><pre xmlns="" class="language-provided"><code class="language-bash">git commit -m "Normalize all the line endings"
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p><code class="command">git reset</code> after removing
              <code class="filename">.git/index</code> is enough to mark files with the
              wrong line endings in the repo and commit those.</p></div><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>When changing file types from text to binary on a Windows
              machine and the workspace wasn't a result from a svn2git
              migration but a git clone then you might end up changing the
              original LF with CRLF because of the initial conversion on
              checkout.</p><p>For example add the following entry <strong class="userinput"><code>*.svg -text
              diff -merge</code></strong> to <code class="filename">.gitattributes</code>
              (see also <a class="link" href="https://github.com/alexkaratarakis/gitattributes/issues/45">SVG
              debate</a>) and the above described procedure might display
              the following results:</p><pre class="language-provided"><code class="language-bash">git status | grep badge-rounded-template.svg
modified: src/main/resources/com/qualinsight/plugins/sonarqube/badges/ws/badge-rounded-template.svg

git ls-files --eol | grep badge-rounded-template.svg
i/lf w/crlf attr/-text src/main/resources/com/qualinsight/plugins/sonarqube/badges/ws/badge-rounded-template.svg
</code></pre><p>In this case a renewed file checkout might be required or
              when all remaining changes are a result of .gitattrubutes
              changes:</p><pre class="language-provided"><code class="language-bash">git reset --hard

git ls-files --eol | grep badge-rounded-template.svg
i/lf w/lf attr/-text src/main/resources/com/qualinsight/plugins/sonarqube/badges/ws/badge-rounded-template.svg

git status
nothing to commit, working tree clean
</code></pre><p>By the way <code class="code">binary</code> is short for <code class="code">-diff
              -merge -text</code>.</p></div></section><section class="section" id="tip.vcs.svn2git.eol.refresh.hard"><div class="titlepage"><div><div><h5 class="title"><a id="tip.vcs.svn2git.eol.refresh.hard" class="anchor" href="#tip.vcs.svn2git.eol.refresh.hard"><span class="octicon octicon-link"/></a>A.2.1.6.3. Refreshing the workspace after changing line
            endings</h5></div></div></div><p>But what if the files in the workspace have the wrong line
            endings. You will see messages like <span class="quote">“<span class="quote">warning: LF will be
            replaced by CRLF in …</span>”</span> and <span class="quote">“<span class="quote">warning: CRLF will be
            replaced by LF in …</span>”</span> .</p><p>After again removing Git's index:</p><pre xmlns="" class="language-provided"><code class="language-bash">del .git\index or rm .git/index
</code></pre><p>Rewrite the Git index to pick up all the new line endings by
            reconverting from HEAD:</p><pre xmlns="" class="language-provided"><code class="language-bash">git reset --hard
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="warning"><h2>Warning</h2><p><code class="command">git reset --hard</code> will revert all
              uncommitted/unadded modified files also and thus will be gone
              (see also <a class="link" href="https://www.freshleafmedia.co.uk/blog/undo-git-reset-hard">Undo-ing
              ‘git reset hard’</a> about <a class="link" href="https://git-scm.com/docs/git-fsck">git fsck
              [--lost-found]</a>).</p></div></section></section><section class="section" id="tip.vcs.svn2git.cloudy"><div class="titlepage"><div><div><h4 class="title"><a id="tip.vcs.svn2git.cloudy" class="anchor" href="#tip.vcs.svn2git.cloudy"><span class="octicon octicon-link"/></a>A.2.1.7. Bitbucket Cloud</h4></div></div></div><p>Push the migrated repository to the cloud:</p><pre xmlns="" class="language-provided"><code class="language-bash">git remote -v
git remote add origin https://bitbucket.org/freedumbytes/jmodalwindow.git
git remote -v
git push --all
</code></pre><p>Also push all the tags to this git repo:</p><pre xmlns="" class="language-provided"><code class="language-bash">git push --tags
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>In case of a Maven project migration do not forget to update
            the <code class="filename">pom.xml</code> to the new SCM:</p><pre class="language-provided"><code class="language-xml">  &lt;scm&gt;
    &lt;developerConnection&gt;
      scm:git:${gitHost}/jmodalwindow.git
    &lt;/developerConnection&gt;
    &lt;url&gt;${fisheyeHost}/browse/jmodalwindow&lt;/url&gt;
    &lt;tag&gt;HEAD&lt;/tag&gt;
  &lt;/scm&gt;
</code></pre></div></section></section><section class="section" id="vcs.git.gitweb.enhancement"><div class="titlepage"><div><div><h3 class="title"><a id="vcs.git.gitweb.enhancement" class="anchor" href="#vcs.git.gitweb.enhancement"><span class="octicon octicon-link"/></a>A.2.2. GitWeb enhancement</h3></div></div></div><p>Might as well use script <a class="link" href="version.control.system.html#vcs.git.bare.project" title="11.1.5. Defining a project"><code class="filename">git-create-repo.sh</code></a>
        to add support for creating repositories to GitWeb by patching
        <code class="filename">P:\dev\apps\vcs\git\share\gitweb\gitweb.cgi</code>:</p><pre xmlns="" class="language-provided"><code class="language-perl">@@ -760,6 +760,8 @@ our @cgi_param_mapping = (
   extra_options =&gt; "opt",
   search_use_regexp =&gt; "sr",
   ctag =&gt; "by_tag",
+  new_project_name =&gt; "pn",
+  new_project_description =&gt; "pd",
   # this must be last entry (for manipulation from JavaScript)
   javascript =&gt; "js"
 );
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -799,6 +801,7 @@ our %actions = (
   "opml" =&gt; \&amp;git_opml,
   "project_list" =&gt; \&amp;git_project_list,
   "project_index" =&gt; \&amp;git_project_index,
+  "create" =&gt; \&amp;git_project_create,
 );
 
 # finally, we have the hash of allowed extra_options for the commands that
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -976,7 +979,7 @@ sub evaluate_path_info {
 
 our ($action, $project, $file_name, $file_parent, $hash, $hash_parent, $hash_base,
      $hash_parent_base, @extra_options, $page, $searchtype, $search_use_regexp,
-     $searchtext, $search_regexp);
+     $searchtext, $search_regexp, $new_project_name, $new_project_description);
 sub evaluate_and_validate_params {
   our $action = $input_params{'action'};
   if (defined $action) {
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -1075,6 +1078,26 @@ sub evaluate_and_validate_params {
     }
     $search_regexp = $search_use_regexp ? $searchtext : quotemeta $searchtext;
   }
+
+  our $new_project_name = $input_params{'new_project_name'};
+  if (defined $new_project_name) {
+    if (length($new_project_name) &lt; 1) {
+      die_error(403, "Project name is a required parameter");
+    }
+    if ($new_project_name =~ m/[^a-zA-Z0-9-]/) {
+      die_error(400, "Invalid project name parameter");
+    }
+  }
+
+  our $new_project_description = $input_params{'new_project_description'};
+  if (defined $new_project_description) {
+    if (length($new_project_description) &lt; 1) {
+      die_error(403, "Project description is a required parameter");
+    }
+    if ($new_project_description =~ m/[^a-zA-Z0-9 -]/) {
+      die_error(400, "Invalid project description parameter");
+    }
+  }
 }
 
 # path to the current git repository
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -1136,7 +1159,7 @@ sub dispatch {
   if (!defined($actions{$action})) {
     die_error(400, "Unknown action");
   }
-  if ($action !~ m/^(?:opml|project_list|project_index)$/ &amp;&amp;
+  if ($action !~ m/^(?:opml|project_list|project_index|create)$/ &amp;&amp;
       !$project) {
     die_error(400, "Project needed");
   }
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -6005,9 +6028,6 @@ sub git_project_list {
   }
 
   my @list = git_get_projects_list();
-  if (!@list) {
-    die_error(404, "No projects found");
-  }
 
   git_header_html();
   if (defined $home_text &amp;&amp; -f $home_text) {
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -6020,10 +6040,29 @@ sub git_project_list {
         $cgi-&gt;textfield(-name =&gt; "s", -value =&gt; $searchtext) . "\n" .
         "&lt;/p&gt;" .
         $cgi-&gt;end_form() . "\n";
-  git_project_list_body(\@list, $order);
+  if (!@list) {
+    print "&lt;center&gt;\n".
+          "&lt;b&gt;No projects found&lt;/b&gt;&lt;br /&gt;\n".
+          "&lt;/center&gt;\n&lt;br /&gt;\n";
+  }
+  else {
+    git_project_list_body(\@list, $order);
+  }
+  git_project_create_form();
   git_footer_html();
 }
 
+sub git_project_create_form {
+  print $cgi-&gt;startform(-method =&gt; "get") .
+        "&lt;p align=\"right\" class=\"projcreate\"&gt;Project Name:\n" .
+        $cgi-&gt;textfield(-name =&gt; "pn", -value =&gt; $searchtext) . "\n" .
+        "Description:\n" .
+        $cgi-&gt;textfield(-name =&gt; "pd", -value =&gt; $searchtext) . "\n" .
+        $cgi-&gt;submit(-name =&gt; "a", -value =&gt; "create") . "\n" .
+        "&lt;/p&gt;" .
+        $cgi-&gt;end_form() . "\n";
+}
+
 sub git_forks {
   my $order = $input_params{'order'};
   if (defined $order &amp;&amp; $order !~ m/none|project|descr|owner|age/) {
</code></pre><pre xmlns="" class="language-provided"><code class="language-perl">@@ -6069,6 +6108,39 @@ sub git_project_index {
   }
 }
 
+sub git_project_create {
+  if (!defined $new_project_name) {
+    die_error(400, "Project name is empty");
+  }
+  if (!defined $new_project_description) {
+    die_error(400, "Project description is empty");
+  }
+
+  my $full_project_name = "$new_project_name.git";
+
+  my @result = `git-create-repo.sh $projectroot $full_project_name "$new_project_description"`;
+  my $exit_value = $? &gt;&gt; 8;
+  $result[-1] =~ s/\n/ /g;
+
+  if ($exit_value eq "9") {
+    die_error(400, "Failed to create project $full_project_name - $result[-1]");
+  }
+  elsif ($exit_value eq "1") {
+    die_error(400, "Unable to create Git repository directory - $result[-1]");
+  }
+  elsif ($exit_value eq "2") {
+    die_error(400, "Project $full_project_name already exists.");
+  }
+  elsif ($exit_value eq "3") {
+    die_error(400, "Couldn't create temporary clone for initial commit - $result[-1]");
+  }
+  elsif ($exit_value eq "4") {
+    die_error(400, "Couldn't cleanup temporary clone for initial commit - $result[-1]");
+  }
+
+  git_project_list();
+}
+
 sub git_summary {
   my $descr = git_get_project_description($project) || "none";
   my %co = parse_commit("HEAD");
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>Make sure git-create-repo.sh is available on the <a class="xref" href="operating.system.html#os.windows.batch.home">BATCH_HOME</a> path.</p></div><p>Now it is possible to create a remote repository with GitWeb.
        Just enter a project name (without <code class="filename">.git</code> suffix) and description by calling
        http://freedumbytes.dev.net/git-repo?pn=gitweb&amp;pd=GitWeb+CGI+enhancement&amp;a=create
        direct or through the user interface enhancement:</p><div class="figure" id="vcs.git.gitweb.enhancement.screenshot"><a id="vcs.git.gitweb.enhancement.screenshot"><span style="display:none;">trick</span></a><div class="figure-contents"><div class="screenshot"><div class="mediaobject"><img src="images/vcs/git/gitweb-enhancement.png" alt="GitWeb enhancement"/></div></div></div><div class="figure-title">Figure A.1. GitWeb enhancement</div></div><br class="figure-break"/></section></section></section><script xmlns="" type="text/javascript" src="js/highlight.min.js"> </script><script xmlns="" type="text/javascript">hljs.initHighlightingOnLoad();</script><footer><ul class="navfooter"><li class="previous"><a accesskey="p" href="quality.assurance.html"><strong>Previous</strong>Chapter 17. Quality Assurance</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="prj.repo.svc.site.hosting.html"><strong>Next</strong>Appendix B. Hosting a group Website in the Cloud</a></li></ul></footer></body></html>