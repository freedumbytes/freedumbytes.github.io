<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE html>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chapter 8. Web Server</title><link rel="stylesheet" type="text/css" href="docbook.css"/><link rel="stylesheet" type="text/css" href="css/freedumbytes.css"/><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"/><link rel="prev" href="http.server.html" title="Chapter 7. HTTP Server"/><link rel="next" href="application.server.html" title="Chapter 9. Application Server"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link rel="shortcut icon" href="./images/community/docbook/glider.ico"/></head><body><header><p id="title"/><ul class="navheader"><li class="previous"><a accesskey="p" href="http.server.html"><strong>Previous</strong></a></li><li class="next"><a accesskey="n" href="application.server.html"><strong>Next</strong></a></li></ul></header><section class="chapter" id="web.server"><div class="titlepage"><div><div><h1 class="title"><a id="web.server" class="anchor" href="#web.server"><span class="octicon octicon-link"/></a>Chapter 8. Web Server</h1></div></div></div><div class="toc"><div class="toc-title">Table of Contents</div><ul class="toc"><li><span class="section"><a href="web.server.html#web.tomcat">8.1. Tomcat</a></span><ul><li><span class="section"><a href="web.server.html#web.tomcat.resources">8.1.1. Resources</a></span></li><li><span class="section"><a href="web.server.html#web.tomcat.install.guide">8.1.2. Tomcat installation guide</a></span></li><li><span class="section"><a href="web.server.html#web.tomcat.windows.service">8.1.3. Windows service</a></span></li><li><span class="section"><a href="web.server.html#web.tomcat.logging">8.1.4. Logging</a></span></li><li><span class="section"><a href="web.server.html#web.tomcat.apache.config">8.1.5. Apache configuration</a></span></li></ul></li></ul></div><section class="section" id="web.tomcat"><div class="titlepage"><div><div><h2 class="title"><a id="web.tomcat" class="anchor" href="#web.tomcat"><span class="octicon octicon-link"/></a>8.1. Tomcat</h2></div></div></div><p><span class="inlinemediaobject"><img src="images/icons/tomcat.png"/></span> Apache <a class="link" href="http://tomcat.apache.org/">Tomcat</a> is an
      implementation of the <a class="link" href="http://www.oracle.com/technetwork/java/javaee/servlet/index.html">Java
      Servlet</a> and <a class="link" href="http://www.oracle.com/technetwork/java/javaee/jsp/index.html">JavaServer
      Pages</a> technologies.</p><section class="section" id="web.tomcat.resources"><div class="titlepage"><div><div><h3 class="title"><a id="web.tomcat.resources" class="anchor" href="#web.tomcat.resources"><span class="octicon octicon-link"/></a>8.1.1. Resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p><a class="link" href="http://tomcat.apache.org/whichversion.html">Download</a>
            Tomcat.</p></li><li class="listitem"><p>Upgrade checklist:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p>Related products: -.</p></li><li class="listitem"><p>References: <a class="link" href="web.server.html#web.tomcat.manager" title="8.1.3.2. Tomcat Manager">Tomcat -
                Manager <code class="code">tomcat8w.exe</code></a> and <a class="link" href="continuous.integration.html#ci.jenkins.install.guide" title="14.1.2. Jenkins installation guide">Jenkins - installation
                guide <code class="code">webapps</code></a>.</p></li><li class="listitem"><p>Integration configuration changes: <a class="link" href="web.server.html#web.tomcat.http.binding" title="8.1.2.1. HTTP Binding">Tomcat - HTTP Binding
                <code class="code">address</code></a>, <a class="link" href="web.server.html#web.tomcat.access" title="8.1.2.2. Tomcat access">Tomcat - access
                <code class="code">tomcat-users.xml</code></a>, <a class="link" href="web.server.html#web.tomcat.windows.service" title="8.1.3. Windows service">Tomcat - Window Service
                <code class="code">tomcat8.exe //US//tomcat</code></a>, <a class="link" href="web.server.html#web.tomcat.windows.user" title="8.1.3.1. Log On Windows user">Tomcat - Account <code class="code">Log
                On</code></a>, <a class="link" href="web.server.html#web.tomcat.logging" title="8.1.4. Logging">Tomcat -
                Logging <code class="code">juli</code> / <code class="code">log4j</code> /
                <code class="code">slf4j</code></a> and <a class="link" href="web.server.html#web.tomcat.remote.authentication" title="8.1.5.1. Remote authentication">Tomcat - Remote
                authentication
                <code class="code">tomcatAuthentication</code></a>.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>Or just run
                  <code class="command">p:\dev\apps\editor\winmerge\WinMergeU.exe
                  p:\dev\apps\webserver\apache-tomcat-8.0.26\conf
                  p:\dev\apps\webserver\apache-tomcat-8.0.17\conf</code> to
                  copy the changes in for example
                  <code class="filename">server.xml</code> and
                  <code class="filename">tomcat-users.xml</code>.</p></div></li></ul></div></li><li class="listitem"><p>Tomcat <a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/index.html">Documentation</a>
            such as <a class="link" href="http://tomcat.apache.org/migration-8.html">Migration
            8.0.x</a>, <a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/config/http.html">HTTP</a>
            and <a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/config/ajp.html">AJP</a>
            Connectors.</p></li></ul></div></section><section class="section" id="web.tomcat.install.guide"><div class="titlepage"><div><div><h3 class="title"><a id="web.tomcat.install.guide" class="anchor" href="#web.tomcat.install.guide"><span class="octicon octicon-link"/></a>8.1.2. Tomcat installation guide</h3></div></div></div><p><a class="link" href="http://tomcat.apache.org/download-80.cgi">Download</a>
        the archive: <code class="filename">apache-tomcat-8.0.26-windows-x64.zip</code>
        [version <a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/changelog.html">8.0.26</a>].</p><p>Extract this <code class="filename">.zip</code> file to
        <code class="filename">P:\dev\apps\webserver</code>.</p><section class="section" id="web.tomcat.http.binding"><div class="titlepage"><div><div><h4 class="title"><a id="web.tomcat.http.binding" class="anchor" href="#web.tomcat.http.binding"><span class="octicon octicon-link"/></a>8.1.2.1. HTTP Binding</h4></div></div></div><p>Configure Tomcat settings <a class="xref" href="web.server.html#web.tomcat.server.port"><img src="images/community/docbook/callouts/1.png" alt="1" border="0" height="17px" width="17px" class="callout"/></a>-<a class="xref" href="web.server.html#web.tomcat.ajp.port"><img src="images/community/docbook/callouts/7.png" alt="7" border="0" height="17px" width="17px" class="callout"/></a> in the file
          <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\conf\server.xml</code>:</p><pre xmlns="" class="language-provided"><code class="language-xml">&lt;Server port="<span xmlns="http://www.w3.org/1999/xhtml" class="strikethrough">8005</span>8070<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.server.port"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.server.port"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/1.png" alt="1" height="17px" width="17px" class="callout"/>" address="127.0.0.1"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.server.address"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.server.address"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/2.png" alt="2" height="17px" width="17px" class="callout"/> shutdown="SHUTDOWN"&gt;
     …
    &lt;Connector port="<span xmlns="http://www.w3.org/1999/xhtml" class="strikethrough">8080</span>8068<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.http.port"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.http.port"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/3.png" alt="3" height="17px" width="17px" class="callout"/>" address="127.0.0.1"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.http.address"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.http.address"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/4.png" alt="4" height="17px" width="17px" class="callout"/> protocol="HTTP/1.1" 
               connectionTimeout="20000" 
               <span xmlns="http://www.w3.org/1999/xhtml" class="strikethrough">redirectPort="8443"</span><span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.no.ssl"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.no.ssl"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/5.png" alt="5" height="17px" width="17px" class="callout"/> URIEncoding="UTF-8"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.i18n"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.i18n"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/6.png" alt="6" height="17px" width="17px" class="callout"/>/&gt;
     …
    &lt;Connector port="<span xmlns="http://www.w3.org/1999/xhtml" class="strikethrough">8009</span>8069<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.port"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.port"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/7.png" alt="7" height="17px" width="17px" class="callout"/>" address="127.0.0.1"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.address"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.address"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/8.png" alt="8" height="17px" width="17px" class="callout"/> protocol="AJP/1.3" 
               <span xmlns="http://www.w3.org/1999/xhtml" class="strikethrough">redirectPort="8443"</span><span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.no.ssl"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.no.ssl"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/5.png" alt="5" height="17px" width="17px" class="callout"/> URIEncoding="UTF-8"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.i18n"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.i18n"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/6.png" alt="6" height="17px" width="17px" class="callout"/>/&gt;
</code></pre></section><section class="section" id="web.tomcat.access"><div class="titlepage"><div><div><h4 class="title"><a id="web.tomcat.access" class="anchor" href="#web.tomcat.access"><span class="octicon octicon-link"/></a>8.1.2.2. Tomcat access</h4></div></div></div><p>Configure Tomcat access in the file
          <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\conf\tomcat-users.xml</code>
          as follows:</p><pre xmlns="" class="language-provided"><code class="language-xml">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;tomcat-users&gt;
  &lt;!-- Tomcat Web Application Manager --&gt;
  &lt;role rolename="manager-gui"/&gt;
  &lt;role rolename="manager-script"/&gt;
  &lt;role rolename="manager-jmx"/&gt;
  &lt;role rolename="manager-status"/&gt;
  
  &lt;!-- Tomcat Virtual Host Manager --&gt;
  &lt;role rolename="admin-gui"/&gt;
  &lt;role rolename="admin-script"/&gt;
  
  &lt;user username="admin" password="<em xmlns="http://www.w3.org/1999/xhtml" class="replaceable"><code>password-gui</code></em>" roles="manager-gui,admin-gui"/&gt;
  &lt;user username="script-tool" password="<em xmlns="http://www.w3.org/1999/xhtml" class="replaceable"><code>password-tool</code></em>" 
        roles="manager-script,admin-script"/&gt;
  &lt;user username="jmx-tool" password="<em xmlns="http://www.w3.org/1999/xhtml" class="replaceable"><code>password-tool</code></em>" roles="manager-jmx"/&gt;
  &lt;user username="status" password="<em xmlns="http://www.w3.org/1999/xhtml" class="replaceable"><code>password-status-only</code></em>" 
        roles="manager-status"/&gt;
&lt;/tomcat-users&gt;
</code></pre><p>These roles are used by the following two applications
          respectively:</p><div class="orderedlist"><ol class="orderedlist compact" type="1"><li class="listitem"><p>Tomcat Web Application Manager:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p>HTML Manager interface (for humans) at <a class="link" href="http://localhost:8068/manager/html">http://localhost:8068/manager/html</a>.</p></li><li class="listitem"><p>Text Manager interface (for scripts) at <a class="link" href="http://localhost:8068/manager/text">http://localhost:8068/manager/text</a>.</p></li><li class="listitem"><p>JMX Proxy interface at <a class="link" href="http://localhost:8068/manager/jmxproxy">http://localhost:8068/manager/jmxproxy</a>.</p></li></ul></div><p>Status interface for all four users at <a class="link" href="http://localhost:8068/manager/status">http://localhost:8068/manager/status</a></p></li><li class="listitem"><p>Tomcat Virtual Host Manager:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p>HTMLHostManager commands at <a class="link" href="http://localhost:8068/host-manager/html">http://localhost:8068/host-manager/html</a>.</p></li><li class="listitem"><p>HostManager commands at <a class="link" href="http://localhost:8068/host-manager/text">http://localhost:8068/host-manager/text</a>.</p></li></ul></div></li></ol></div></section></section><section class="section" id="web.tomcat.windows.service"><div class="titlepage"><div><div><h3 class="title"><a id="web.tomcat.windows.service" class="anchor" href="#web.tomcat.windows.service"><span class="octicon octicon-link"/></a>8.1.3. Windows service</h3></div></div></div><p>To restart automatically on Microsoft Windows <a class="link" href="http://tomcat.apache.org/tomcat-7.0-doc/windows-service-howto.html">create
        a service</a> using <a class="link" href="operating.system.html#os.windows.cmd.elevated" title="1.1.14.1. Elevated Command Prompt">an
        elevated command prompt</a> as follows:</p><pre xmlns="" class="language-provided"><code class="language-bash">cd /d P:\dev\apps\webserver\apache-tomcat-8.0.26

set JAVA_HOME=P:\dev\apps\prg\java-x64\jdk1.8.0_162
set CATALINA_HOME=P:\dev\apps\webserver\apache-tomcat-8.0.26
bin\service.bat install tomcat

bin\tomcat8.exe //US//tomcat --DisplayName="freedumbytes.dev.net Tomcat" ^
  --Description="Tomcat is an open source web server." ^
  --Startup=auto

bin\tomcat8.exe //US//tomcat --JvmMx=512 --JvmMs=128
</code></pre><p>Start it with <code class="command">net start tomcat</code>.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>In case of an upgrade <code class="command">sc delete tomcat</code>
          first (see also <a class="xref" href="operating.system.html#os.windows.process.explorer" title="1.1.5. Task Manager replacement">Section 1.1.5, “Task Manager replacement”</a> in
          case of <span class="quote">“<span class="quote">The specified service has been marked for
          deletion.</span>”</span>).</p></div><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>In case of a new jdk installation just run
          <code class="command">P:\dev\apps\webserver\apache-tomcat-8.0.26\bin\tomcat8.exe
          //US//tomcat --Jvm auto</code> (when <code class="envar">JAVA_HOME</code> is
          still pointing to the 64-bit version; see also <a class="xref" href="web.server.html#web.tomcat.manager" title="8.1.3.2. Tomcat Manager">Section 8.1.3.2, “Tomcat Manager”</a>).</p></div><p>Verify the installation and the JVM memory usage at <a class="link" href="http://localhost:8068/manager/status">http://localhost:8068/manager/status</a>.</p><section class="section" id="web.tomcat.windows.user"><div class="titlepage"><div><div><h4 class="title"><a id="web.tomcat.windows.user" class="anchor" href="#web.tomcat.windows.user"><span class="octicon octicon-link"/></a>8.1.3.1. Log On Windows user</h4></div></div></div><p>For easier management of user specific files such as for
          example the Maven
          <code class="filename">C:\Users\tomcat\.m2\settings-security.xml</code>
          select <span class="guimenuitem"><strong>Start Menu</strong></span> → <span class="guimenuitem"><strong>Control Panel</strong></span> → <span class="guimenuitem"><strong>User Accounts and Family Safety</strong></span> → <span class="guimenuitem"><strong>User Accounts</strong></span> → <span class="guimenuitem"><strong>Add or remove user accounts</strong></span> → <span class="guimenuitem"><strong>Create a new account</strong></span> <strong class="userinput"><code>Tomcat</code></strong> as
          <span class="guilabel"><strong><span class="accel">S</span>tandard user</strong></span> and click
          <span class="guibutton"><strong>Create Account</strong></span>. Select this new user and
          <span class="guilabel"><strong>Create a password</strong></span>. Also <span class="guilabel"><strong>Change the
          picture</strong></span> with <span class="guilabel"><strong>Browse for more
          pictures…</strong></span>
          <strong class="userinput"><code>P:\dev\apps\webserver\apache-tomcat-8.0.26\webapps\ROOT\tomcat.png</code></strong>
          and click <span class="guibutton"><strong><span class="accel">O</span>pen</strong></span>.</p><p>Launch the <span class="application"><strong>Service Management
          Console</strong></span> with <code class="command">services.msc</code>. Right
          click on <span class="guilabel"><strong>freedumbytes.dev.net Tomcat</strong></span> and select
          <span class="guimenuitem"><strong>P<span class="accel">r</span>operties</strong></span> → <span class="guilabel"><strong>Log On</strong></span> to use <span class="guilabel"><strong><span class="accel">T</span>his
          account</strong></span> <strong class="userinput"><code>.\Tomcat</code></strong>. After password
          conformation click <span class="guibutton"><strong><span class="accel">A</span>pply</strong></span> and
          restart the service.</p><section class="section" id="web.tomcat.windows.user.netrc"><div class="titlepage"><div><div><h5 class="title"><a id="web.tomcat.windows.user.netrc" class="anchor" href="#web.tomcat.windows.user.netrc"><span class="octicon octicon-link"/></a>8.1.3.1.1. netrc</h5></div></div></div><p>The _netrc file contains login and initialization
            information used by the auto-login process.</p><p>When logged in as tomcat user type the following
            commands:</p><pre xmlns="" class="language-provided"><code class="language-bash">setx HOME %USERPROFILE%
echo machine freedumbytes.dev.net login jenkins password <em xmlns="http://www.w3.org/1999/xhtml" class="replaceable"><code>&lt;password&gt;</code></em> &gt;&gt; %USERPROFILE%\_netrc
</code></pre><p>This way the Jenkins build jobs will be able to auto-login
            to the git-repo on freedumbytes.dev.net.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>The usage of <a class="xref" href="continuous.integration.html#ci.jenkins.config.git" title="14.1.4.5. Git authentication">Section 14.1.4.5, “Git authentication”</a> is a
              better alternative.</p></div><p>Restart tomcat service to pick up the <code class="envar">HOME</code>
            setting.</p></section></section><section class="section" id="web.tomcat.manager"><div class="titlepage"><div><div><h4 class="title"><a id="web.tomcat.manager" class="anchor" href="#web.tomcat.manager"><span class="octicon octicon-link"/></a>8.1.3.2. Tomcat Manager</h4></div></div></div><p><a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/windows-service-howto.html">Tomcat8w</a>
          is a GUI application for monitoring and configuring Tomcat
          services.</p><p>To monitor the tomcat service run:
          <code class="command">P:\dev\apps\webserver\apache-tomcat-8.0.26\bin\tomcat8w.exe
          //MS//tomcat</code> or create a shortcut <span class="guilabel"><strong>Tomcat
          Manager</strong></span> for it and edit <span class="guimenuitem"><strong>P<span class="accel">r</span>operties</strong></span> → <span class="guilabel"><strong><span class="accel">T</span>arget</strong></span> to include the correct service name
          <strong class="userinput"><code>P:\dev\apps\webserver\apache-tomcat-8.0.26\bin\tomcat8w.exe
          //MS//tomcat</code></strong>.</p><p>When the Tomcat Manager is running, you can see the
          freedumbytes.dev.net Tomcat icon <span class="inlinemediaobject"><img src="images/webserver/tomcat/TomcatManager.png"/></span> in the system tray. Right click on this icon
          and select <span class="guimenuitem"><strong>Configure</strong></span> to activate the
          console in which the Apache Tomcat Server can be (re)started and
          stopped.</p><div style="margin-left: 0.5in; margin-right: 0.5in;" class="note"><h2>Note</h2><p>When the monitor application was already running when the
            Log On account was changed (as described in the prior <a class="xref" href="web.server.html#web.tomcat.windows.user" title="8.1.3.1. Log On Windows user">Section 8.1.3.1, “Log On Windows user”</a>) right click on its icon
            <span class="inlinemediaobject"><img src="images/webserver/tomcat/TomcatManager.png"/></span> and select <span class="guimenuitem"><strong>Exit</strong></span>
            and then restart it. Because this change wont show up
            otherwise.</p></div><div style="margin-left: 0.5in; margin-right: 0.5in;" class="tip"><h2>Tip</h2><p>As an alternative to change the additional settings of the
            Tomcat service run:
            <code class="command">P:\dev\apps\webserver\apache-tomcat-8.0.26\bin\tomcat8w.exe
            //MS//tomcat</code> such as <span class="guilabel"><strong>Java</strong></span> → <span class="guilabel"><strong>Java Virtual Machine</strong></span>
            <strong class="userinput"><code>P:\dev\apps\prg\java-x64\jdk1.8.0_162\jre\bin\server\jvm.dll</code></strong>.</p></div></section></section><section class="section" id="web.tomcat.logging"><div class="titlepage"><div><div><h3 class="title"><a id="web.tomcat.logging" class="anchor" href="#web.tomcat.logging"><span class="octicon octicon-link"/></a>8.1.4. Logging</h3></div></div></div><p>Tomcat 7.0 uses Commons Logging throughout its internal code
        allowing the developer to choose a logging configuration that suits
        their needs such as Log4J.</p><p>To switch to Log4J apply the following steps after shutting down
        tomcat with <code class="command">net stop tomcat</code>:</p><div class="orderedlist"><ol class="orderedlist compact" type="1"><li class="listitem"><p>Tomcat replacements:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p><a class="link" href="http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.26/bin/extras/">Download</a>:
                <code class="filename">tomcat-juli-adapters.jar</code> and
                <code class="filename">tomcat-juli.jar</code> [version <a class="link" href="http://tomcat.apache.org/tomcat-8.0-doc/changelog.html">8.0.26</a>].</p></li><li class="listitem"><p>Replace the <code class="filename">tomcat-juli.jar</code> in
                <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\bin</code>.</p></li><li class="listitem"><p>Install the
                <code class="filename">tomcat-juli-adapters.jar</code> in the <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\lib</code>
                directory.</p></li></ul></div></li><li class="listitem"><p><span class="inlinemediaobject"><img src="images/icons/log4j.png"/></span> <a class="link" href="http://logging.apache.org/log4j/">Log4J</a>
            integration:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p><a class="link" href="http://logging.apache.org/log4j/1.2/download.html">Download</a>:
                <code class="filename">apache-log4j-1.2.17.zip</code> [version <a class="link" href="http://logging.apache.org/log4j/1.2/download.html">1.2.17</a>].</p></li><li class="listitem"><p>Install the <code class="filename">log4j-1.2.17.jar</code> in the
                <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\lib</code>
                directory.</p></li></ul></div></li><li class="listitem"><p><span class="inlinemediaobject"><img src="images/icons/slf4j.png"/></span> <a class="link" href="http://www.slf4j.org/">SLF4J</a>
            integration:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p><a class="link" href="http://www.slf4j.org/download.html">Download</a>:
                <code class="filename">slf4j-1.7.12.zip</code> used by frameworks such
                as Hibernate [version <a class="link" href="http://www.slf4j.org/download.html">1.7.12</a>].</p></li><li class="listitem"><p>Install the <code class="filename">slf4j-api-1.7.12.jar</code> in
                the <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\lib</code>
                directory.</p></li><li class="listitem"><p>And <a class="link" href="http://www.slf4j.org/manual.html#swapping">bind</a>
                SLF4J to Log4J by installing the
                <code class="filename">slf4j-log4j12-1.7.12.jar</code> in the <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\lib</code>
                directory.</p></li></ul></div></li><li class="listitem"><p>Logging configuration:</p><div class="itemizedlist"><ul class="itemizedlist compact"><li class="listitem"><p>Create a file called <code class="filename">log4j.xml</code> in
                <code class="filename">P:\dev\logs\webserver\tomcat</code> with
                the following content:</p><pre xmlns="" class="language-provided"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration 
          SYSTEM "http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/xml/doc-files/log4j.dtd"&gt;

&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="true"&gt;
  &lt;appender name="FILE" class="org.apache.log4j.RollingFileAppender"&gt;
    &lt;param name="File" value="P:/dev/logs/webserver/tomcat/tomcat.log4j"/&gt;
    &lt;param name="Append" value="true"/&gt;
    &lt;param name="MaxFileSize" value="100MB"/&gt;
    &lt;param name="MaxBackupIndex" value="5"/&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%d %-5p [%t] %c{2} %x - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;

  &lt;logger name="org.apache.catalina"&gt;
    &lt;level value="INFO"/&gt;
  &lt;/logger&gt;

  &lt;root&gt;
    &lt;level value="INFO"/&gt;
    &lt;appender-ref ref="FILE"/&gt;
  &lt;/root&gt;
&lt;/log4j:configuration&gt;
</code></pre></li><li class="listitem"><p>Delete the obsolete
                <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\conf\logging.properties</code>
                or rename to
                <code class="filename">logging.properties.obsolete</code>.</p></li><li class="listitem"><p>Configure the tomcat service to use the
                <code class="filename">log4j.xml</code> instead as follows:</p><pre xmlns="" class="language-provided"><code class="language-bash">cd /d P:\dev\apps\webserver\apache-tomcat-8.0.26

bin\tomcat8.exe //US//tomcat ^
  ++JvmOptions=-Dlog4j.configuration=^
    file:///P:/dev/logs/webserver/tomcat/log4j.xml

bin\tomcat8.exe //US//tomcat ^
  --LogPath=P:/dev/logs/webserver/tomcat
</code></pre><p>Open the Tomcat Manager <span class="inlinemediaobject"><img src="images/webserver/tomcat/TomcatManager.png"/></span> in the system tray by right clicking on
                this icon and selecting <span class="guimenuitem"><strong>Configure</strong></span>.
                In the <span class="guilabel"><strong>Java</strong></span> tab remove the now obsolete
                <span class="guilabel"><strong>Java Options</strong></span> parameter
                <strong class="userinput"><code>-Djava.util.logging.config.file=P:\dev\apps\webserver\apache-tomcat-8.0.26\conf\logging.properties</code></strong>.</p></li></ul></div></li></ol></div></section><section class="section" id="web.tomcat.apache.config"><div class="titlepage"><div><div><h3 class="title"><a id="web.tomcat.apache.config" class="anchor" href="#web.tomcat.apache.config"><span class="octicon octicon-link"/></a>8.1.5. Apache configuration</h3></div></div></div><p>Instruct Apache to <a class="link" href="http.server.html#http.apache.config.proxy" title="7.1.9. Proxy configuration">proxy</a> all URLs whose path
        portions begin with <code class="uri">/tomcat/</code> using the following
        <code class="filename">P:\dev\apps\httpserver\apache-conf\httpd-vhosts.conf</code>
        include <a class="xref" href="web.server.html#http.apache.include.httpd.tomcat"><img src="images/community/docbook/callouts/1.png" alt="1" border="0" height="17px" width="17px" class="callout"/></a>:</p><pre xmlns="" class="language-provided"><code class="language-apache">&lt;VirtualHost *:80&gt;
   …

  &lt;IfModule proxy_module&gt;
  &lt;IfModule proxy_http_module&gt;
     …

    &lt;Proxy *&gt;
      …
    &lt;/Proxy&gt;

    # Tomcat
    Include ../apache-conf/httpd-tomcat.conf<span xmlns="http://www.w3.org/1999/xhtml" id="http.apache.include.httpd.tomcat"/><a xmlns="http://www.w3.org/1999/xhtml" id="http.apache.include.httpd.tomcat"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/1.png" alt="1" height="17px" width="17px" class="callout"/>
  &lt;/IfModule&gt;
  &lt;/IfModule&gt;
&lt;/VirtualHost&gt;
</code></pre><p>with the following content in
        <code class="filename">P:\dev\apps\httpserver\apache-conf\httpd-tomcat.conf</code>
        (see also <a class="xref" href="http.server.html#http.apache.config.html.rewriting" title="7.1.9.2. Html rewrite configuration">Section 7.1.9.2, “Html rewrite configuration”</a>):</p><pre xmlns="" class="language-provided"><code class="language-apache">&lt;IfModule headers_module&gt;
&lt;IfModule proxy_html_module&gt;
&lt;IfModule proxy_module&gt;
&lt;IfModule proxy_http_module&gt;
  Redirect /tomcat   /tomcat/
  ProxyPass /tomcat/ http://localhost:8068/

  &lt;Location /tomcat/&gt;
    ProxyPassReverse /
    ProxyHTMLEnable On
    RequestHeader unset Accept-Encoding
    ProxyHTMLURLMap http://localhost:8068 /tomcat
    ProxyHTMLURLMap /                     /tomcat/
    ProxyHTMLURLMap /tomcat/              /tomcat/

    &lt;RequireAll&gt;
      Include ../apache-conf/httpd-lan-access.conf<span xmlns="http://www.w3.org/1999/xhtml" id="http.apache.tomcat.access.require.ip"/><a xmlns="http://www.w3.org/1999/xhtml" id="http.apache.tomcat.access.require.ip"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/1.png" alt="1" height="17px" width="17px" class="callout"/>
    &lt;/RequireAll&gt;
  &lt;/Location&gt;
&lt;/IfModule&gt;
&lt;/IfModule&gt;
&lt;/IfModule&gt;
&lt;/IfModule&gt;
</code></pre><div style="margin-left: 0.5in; margin-right: 0.5in;" class="important"><h2>Important</h2><p>Notice that only local access <a class="xref" href="web.server.html#http.apache.tomcat.access.require.ip"><img style="border: 0; " src="images/community/docbook/callouts/1.png" alt="1" height="17px" width="17px" class="callout"/></a> is activated and
            not the freedumbytes.dev.net realm because this clashes with the
            basic authentication of Tomcat itself resulting in the following
            error <span class="quote">“<span class="quote">AH01618: user admin not found:
            /tomcat/manager/status, referer:
            http://freedumbytes.dev.net/tomcat/</span>”</span> and hanging HTTP
            requests.</p></div><section class="section" id="web.tomcat.remote.authentication"><div class="titlepage"><div><div><h4 class="title"><a id="web.tomcat.remote.authentication" class="anchor" href="#web.tomcat.remote.authentication"><span class="octicon octicon-link"/></a>8.1.5.1. Remote authentication</h4></div></div></div><p>For the AJP protocol connector tell Tomcat not to use its
          internal (primitive) authentication mechanism, but instead to use
          remote authentication provided by the front-end web server with the
          following setting <a class="xref" href="web.server.html#web.tomcat.ajp.authentication"><img src="images/community/docbook/callouts/1.png" alt="1" border="0" height="17px" width="17px" class="callout"/></a> in
          the file
          <code class="filename">P:\dev\apps\webserver\apache-tomcat-8.0.26\conf\server.xml</code>:</p><pre xmlns="" class="language-provided"><code class="language-xml">    &lt;Connector address="127.0.0.1" port="8069" protocol="AJP/1.3" 
               tomcatAuthentication="false"<span xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.authentication"/><a xmlns="http://www.w3.org/1999/xhtml" id="web.tomcat.ajp.authentication"><span style="display:none;">trick</span></a><img xmlns="http://www.w3.org/1999/xhtml" style="border: 0; " src="images/community/docbook/callouts/1.png" alt="1" height="17px" width="17px" class="callout"/> URIEncoding="UTF-8"/&gt;</code></pre><p>This can be useful for passing on authenticated users to for
          example applications such as <a class="link" href="continuous.integration.html#ci.jenkins" title="14.1. Jenkins">Jenkins</a>.</p><p>When the Tomcat web server and the Apache HTTP Server are
          restarted you should be able to browse Tomcat at <a class="link" href="http://freedumbytes.dev.net/tomcat/">http://freedumbytes.dev.net/tomcat/</a>.</p></section></section></section></section><script xmlns="" type="text/javascript" src="js/highlight.min.js"> </script><script xmlns="" type="text/javascript">hljs.initHighlightingOnLoad();</script><footer><ul class="navfooter"><li class="previous"><a accesskey="p" href="http.server.html"><strong>Previous</strong>Chapter 7. HTTP Server</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="application.server.html"><strong>Next</strong>Chapter 9. Application Server</a></li></ul></footer></body></html>